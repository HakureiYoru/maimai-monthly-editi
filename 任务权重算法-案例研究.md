# 任务权重算法 - 详细案例研究文档

## 📋 目录
1. [算法概述](#算法概述)
2. [参数定义与当前设定](#参数定义与当前设定)
3. [案例研究分类](#案例研究分类)
4. [详细案例分析](#详细案例分析)
5. [边界情况测试](#边界情况测试)
6. [参数调优建议](#参数调优建议)
7. [实际数据对比](#实际数据对比)

---

## 算法概述

### 核心公式

```
最终任务权重 = 基础冷门权重 × 均衡因子

基础冷门权重 = 评分缺口比例 × 45 + 时间紧迫度加成
评分缺口比例 = (期望评分 - 当前评分) / 期望评分

均衡因子 = 根据当前高低权重比例动态调整
```

### 目标设定
- **期望评分数**: 20 人
- **目标高低比例**: 1:2 (高权重:低权重)
- **容忍度**: ±20%
- **均衡区间**: 40%-60% 高权重占比

---

## 参数定义与当前设定

### 1. 基础权重参数

| 参数名称 | 当前值 | 说明 |
|---------|--------|------|
| 评分缺口系数 | 45 | 缺口比例的放大倍数 |
| 期望评分数 | 20 | 目标评分人数 |
| 时间加成-7天阈值 | +12 | 7天且<10评分 |
| 时间加成-14天阈值 | +18 | 14天且<15评分 |
| 时间加成-21天阈值 | +25 | 21天且<18评分 |

### 2. 均衡因子参数

| 高权重占比 | Qualified用户因子 | 普通用户因子 | 状态 |
|-----------|-----------------|------------|------|
| > 60% | ×0.7 | ×1.3 | 高权重过多 |
| 40%-60% | ×1.0 | ×1.0 | 比例均衡 |
| < 40% | ×1.3 | ×0.7 | 高权重不足 |

---

## 案例研究分类

### 按作品状态分类
1. **新提交作品** (0-7天)
2. **中期作品** (8-14天)
3. **后期作品** (15-21天)
4. **超期作品** (>21天)

### 按评分进度分类
1. **未评分** (0人)
2. **极少评分** (1-5人)
3. **部分评分** (6-15人)
4. **接近目标** (16-19人)
5. **已达标** (≥20人)

### 按高低权重比例分类
1. **高权重过多** (>60%)
2. **比例均衡** (40%-60%)
3. **高权重不足** (<40%)
4. **纯高权重** (100%高)
5. **纯低权重** (100%低)

---

## 详细案例分析

## Case 1: 新提交作品系列

### Case 1.1: 完全无评分的新作品
**作品状态**
- 提交天数: 3天
- 当前评分: 0人
- 高权重: 0人
- 低权重: 0人
- 高权重占比: N/A (无评分)

**计算过程**
```
评分缺口比例 = (20 - 0) / 20 = 1.0
基础冷门权重 = 1.0 × 45 + 0 = 45
时间加成 = 0 (不满足7天且<10评分条件)

均衡因子:
- Qualified用户: ×1.0 (无评分时默认均衡)
- 普通用户: ×1.0 (无评分时默认均衡)

最终权重:
- Qualified用户: 45 × 1.0 = 45
- 普通用户: 45 × 1.0 = 45
```

**分析**: 两类用户权重相同，适合冷启动阶段


### Case 1.2: 新作品，仅有1个高权重评分
**作品状态**
- 提交天数: 5天
- 当前评分: 1人
- 高权重: 1人
- 低权重: 0人
- 高权重占比: 100%

**计算过程**
```
评分缺口比例 = (20 - 1) / 20 = 0.95
基础冷门权重 = 0.95 × 45 = 42.75 → 43

均衡因子:
- Qualified用户: ×0.7 (高权重过多)
- 普通用户: ×1.3 (高权重过多)

最终权重:
- Qualified用户: 43 × 0.7 = 30.1 → 30
- 普通用户: 43 × 1.3 = 55.9 → 56
```

**分析**: 系统快速引导低权重用户评分，平衡比例


### Case 1.3: 新作品，仅有1个低权重评分
**作品状态**
- 提交天数: 5天
- 当前评分: 1人
- 高权重: 0人
- 低权重: 1人
- 高权重占比: 0%

**计算过程**
```
评分缺口比例 = 0.95
基础冷门权重 = 43

均衡因子:
- Qualified用户: ×1.3 (高权重不足)
- 普通用户: ×0.7 (高权重不足)

最终权重:
- Qualified用户: 43 × 1.3 = 55.9 → 56
- 普通用户: 43 × 0.7 = 30.1 → 30
```

**分析**: 引导高权重用户补充评分


### Case 1.4: 新作品，达到7天时间阈值
**作品状态**
- 提交天数: 7天
- 当前评分: 5人
- 高权重: 2人
- 低权重: 3人
- 高权重占比: 40%

**计算过程**
```
评分缺口比例 = (20 - 5) / 20 = 0.75
基础权重 = 0.75 × 45 = 33.75
时间加成 = +12 (满足7天且<10评分)
基础冷门权重 = 33.75 + 12 = 45.75 → 46

均衡因子:
- Qualified用户: ×1.0 (处于均衡区间40%)
- 普通用户: ×1.0 (处于均衡区间40%)

最终权重:
- Qualified用户: 46 × 1.0 = 46
- 普通用户: 46 × 1.0 = 46
```

**分析**: 时间加成开始生效，权重显著提升


---

## Case 2: 中期作品系列

### Case 2.1: 中期作品，评分不足且高权重过多
**作品状态**
- 提交天数: 10天
- 当前评分: 8人
- 高权重: 6人
- 低权重: 2人
- 高权重占比: 75%

**计算过程**
```
评分缺口比例 = (20 - 8) / 20 = 0.60
基础权重 = 0.60 × 45 = 27
时间加成 = 0 (不满足阈值)
基础冷门权重 = 27

均衡因子:
- Qualified用户: ×0.7 (高权重过多 >60%)
- 普通用户: ×1.3 (高权重过多 >60%)

最终权重:
- Qualified用户: 27 × 0.7 = 18.9 → 19
- 普通用户: 27 × 1.3 = 35.1 → 35
```

**分析**: 普通用户权重比Qualified高85%，强力纠偏


### Case 2.2: 中期作品，评分不足且低权重过多
**作品状态**
- 提交天数: 10天
- 当前评分: 8人
- 高权重: 2人
- 低权重: 6人
- 高权重占比: 25%

**计算过程**
```
评分缺口比例 = 0.60
基础冷门权重 = 27

均衡因子:
- Qualified用户: ×1.3 (高权重不足 <40%)
- 普通用户: ×0.7 (高权重不足 <40%)

最终权重:
- Qualified用户: 27 × 1.3 = 35.1 → 35
- 普通用户: 27 × 0.7 = 18.9 → 19
```

**分析**: Qualified用户权重比普通高84%


### Case 2.3: 中期作品，达到14天时间阈值
**作品状态**
- 提交天数: 14天
- 当前评分: 12人
- 高权重: 5人
- 低权重: 7人
- 高权重占比: 41.7%

**计算过程**
```
评分缺口比例 = (20 - 12) / 20 = 0.40
基础权重 = 0.40 × 45 = 18
时间加成 = +18 (满足14天且<15评分)
基础冷门权重 = 18 + 18 = 36

均衡因子:
- Qualified用户: ×1.0 (均衡区间41.7%)
- 普通用户: ×1.0 (均衡区间41.7%)

最终权重:
- Qualified用户: 36 × 1.0 = 36
- 普通用户: 36 × 1.0 = 36
```

**分析**: 时间加成翻倍基础权重，紧迫度提升


### Case 2.4: 中期作品，比例刚好在边界
**作品状态**
- 提交天数: 12天
- 当前评分: 10人
- 高权重: 6人
- 低权重: 4人
- 高权重占比: 60% (刚好边界)

**计算过程**
```
评分缺口比例 = (20 - 10) / 20 = 0.50
基础冷门权重 = 0.50 × 45 = 22.5 → 23

均衡因子:
- Qualified用户: ×1.0 (60%算作均衡区间)
- 普通用户: ×1.0 (60%算作均衡区间)

最终权重:
- Qualified用户: 23 × 1.0 = 23
- 普通用户: 23 × 1.0 = 23
```

**分析**: 边界值处理需要明确定义


---

## Case 3: 后期作品系列

### Case 3.1: 后期作品，评分严重不足
**作品状态**
- 提交天数: 18天
- 当前评分: 8人
- 高权重: 5人
- 低权重: 3人
- 高权重占比: 62.5%

**计算过程**
```
评分缺口比例 = (20 - 8) / 20 = 0.60
基础权重 = 0.60 × 45 = 27
时间加成 = 0 (不满足<18评分但天数不够21天)
基础冷门权重 = 27

均衡因子:
- Qualified用户: ×0.7 (高权重过多)
- 普通用户: ×1.3 (高权重过多)

最终权重:
- Qualified用户: 27 × 0.7 = 18.9 → 19
- 普通用户: 27 × 1.3 = 35.1 → 35
```

**分析**: 虽然天数长，但未达到时间加成阈值


### Case 3.2: 后期作品，达到21天紧急阈值
**作品状态**
- 提交天数: 21天
- 当前评分: 15人
- 高权重: 6人
- 低权重: 9人
- 高权重占比: 40%

**计算过程**
```
评分缺口比例 = (20 - 15) / 20 = 0.25
基础权重 = 0.25 × 45 = 11.25
时间加成 = +25 (满足21天且<18评分)
基础冷门权重 = 11.25 + 25 = 36.25 → 36

均衡因子:
- Qualified用户: ×1.0 (均衡区间)
- 普通用户: ×1.0 (均衡区间)

最终权重:
- Qualified用户: 36 × 1.0 = 36
- 普通用户: 36 × 1.0 = 36
```

**分析**: 最高时间加成，确保作品获得足够关注


### Case 3.3: 后期作品，接近目标且比例失衡
**作品状态**
- 提交天数: 20天
- 当前评分: 18人
- 高权重: 14人
- 低权重: 4人
- 高权重占比: 77.8%

**计算过程**
```
评分缺口比例 = (20 - 18) / 20 = 0.10
基础权重 = 0.10 × 45 = 4.5
时间加成 = +25 (满足21天且<18评分? 18人不满足)
实际时间加成 = 0
基础冷门权重 = 4.5 → 5

均衡因子:
- Qualified用户: ×0.7 (高权重过多)
- 普通用户: ×1.3 (高权重过多)

最终权重:
- Qualified用户: 5 × 0.7 = 3.5 → 4
- 普通用户: 5 × 1.3 = 6.5 → 7
```

**分析**: 虽然接近目标，但仍需要纠正比例失衡


---

## Case 4: 极端情况系列

### Case 4.1: 刚好达标作品
**作品状态**
- 提交天数: 15天
- 当前评分: 20人
- 高权重: 7人
- 低权重: 13人
- 高权重占比: 35%

**计算过程**
```
评分缺口比例 = (20 - 20) / 20 = 0.0
基础冷门权重 = 0.0 × 45 = 0

均衡因子: 无关紧要

最终权重:
- Qualified用户: 0
- 普通用户: 0
```

**分析**: 达标作品不再出现在任务列表中


### Case 4.2: 超期严重的冷门作品
**作品状态**
- 提交天数: 28天
- 当前评分: 3人
- 高权重: 1人
- 低权重: 2人
- 高权重占比: 33.3%

**计算过程**
```
评分缺口比例 = (20 - 3) / 20 = 0.85
基础权重 = 0.85 × 45 = 38.25
时间加成 = +25 (满足21天且<18评分)
基础冷门权重 = 38.25 + 25 = 63.25 → 63

均衡因子:
- Qualified用户: ×1.3 (高权重不足)
- 普通用户: ×0.7 (高权重不足)

最终权重:
- Qualified用户: 63 × 1.3 = 81.9 → 82
- 普通用户: 63 × 0.7 = 44.1 → 44
```

**分析**: 权重极高，系统优先推送给所有用户


### Case 4.3: 全部Qualified评分的作品
**作品状态**
- 提交天数: 10天
- 当前评分: 10人
- 高权重: 10人
- 低权重: 0人
- 高权重占比: 100%

**计算过程**
```
评分缺口比例 = (20 - 10) / 20 = 0.50
基础冷门权重 = 0.50 × 45 = 22.5 → 23

均衡因子:
- Qualified用户: ×0.7 (高权重过多)
- 普通用户: ×1.3 (高权重过多)

最终权重:
- Qualified用户: 23 × 0.7 = 16.1 → 16
- 普通用户: 23 × 1.3 = 29.9 → 30
```

**分析**: 强烈引导普通用户参与


### Case 4.4: 全部普通用户评分的作品
**作品状态**
- 提交天数: 10天
- 当前评分: 10人
- 高权重: 0人
- 低权重: 10人
- 高权重占比: 0%

**计算过程**
```
评分缺口比例 = 0.50
基础冷门权重 = 23

均衡因子:
- Qualified用户: ×1.3 (高权重不足)
- 普通用户: ×0.7 (高权重不足)

最终权重:
- Qualified用户: 23 × 1.3 = 29.9 → 30
- 普通用户: 23 × 0.7 = 16.1 → 16
```

**分析**: 强烈引导Qualified用户参与


### Case 4.5: 接近边界的高权重占比 (61%)
**作品状态**
- 提交天数: 12天
- 当前评分: 18人
- 高权重: 11人
- 低权重: 7人
- 高权重占比: 61.1%

**计算过程**
```
评分缺口比例 = (20 - 18) / 20 = 0.10
基础冷门权重 = 0.10 × 45 = 4.5 → 5

均衡因子:
- Qualified用户: ×0.7 (刚过60%边界)
- 普通用户: ×1.3 (刚过60%边界)

最终权重:
- Qualified用户: 5 × 0.7 = 3.5 → 4
- 普通用户: 5 × 1.3 = 6.5 → 7
```

**分析**: 微小差异触发因子变化，可能需要更平滑的过渡


### Case 4.6: 接近边界的高权重占比 (39%)
**作品状态**
- 提交天数: 12天
- 当前评分: 18人
- 高权重: 7人
- 低权重: 11人
- 高权重占比: 38.9%

**计算过程**
```
评分缺口比例 = 0.10
基础冷门权重 = 5

均衡因子:
- Qualified用户: ×1.3 (刚低于40%边界)
- 普通用户: ×0.7 (刚低于40%边界)

最终权重:
- Qualified用户: 5 × 1.3 = 6.5 → 7
- 普通用户: 5 × 0.7 = 3.5 → 4
```

**分析**: 边界跳跃明显，建议考虑渐变机制


---

## Case 5: 多作品对比场景

### 场景 5.1: 三个作品同时存在，用户如何选择？

**作品A - 新作品无评分**
- 天数: 3天, 评分: 0人
- Qualified权重: 45, 普通权重: 45

**作品B - 中期作品高权重过多**
- 天数: 10天, 评分: 8人 (6高/2低)
- Qualified权重: 19, 普通权重: 35

**作品C - 超期冷门作品**
- 天数: 25天, 评分: 5人 (2高/3低)
- Qualified权重: 69, 普通权重: 47

**Qualified用户任务列表排序**
1. 作品C (权重69) - 超期冷门，最优先
2. 作品A (权重45) - 新作品冷启动
3. 作品B (权重19) - 高权重过多，权重被压低

**普通用户任务列表排序**
1. 作品C (权重47) - 超期冷门
2. 作品A (权重45) - 新作品
3. 作品B (权重35) - 高权重过多，需要低权重补充


### 场景 5.2: 时间加成的优先级测试

**作品A - 刚达7天阈值**
- 天数: 7天, 评分: 9人 (4高/5低, 44%)
- 基础权重: 24.75, 时间加成: +12
- 最终: Qualified 37, 普通 37

**作品B - 刚达14天阈值**
- 天数: 14天, 评分: 14人 (6高/8低, 43%)
- 基础权重: 13.5, 时间加成: +18
- 最终: Qualified 32, 普通 32

**作品C - 刚达21天阈值**
- 天数: 21天, 评分: 17人 (7高/10低, 41%)
- 基础权重: 6.75, 时间加成: +25
- 最终: Qualified 32, 普通 32

**观察**: 21天阈值的时间加成非常强大，即使评分接近目标也能保持高权重


---

## Case 6: 实际用户场景模拟

### 场景 6.1: Qualified用户张三的任务列表

**张三资料**
- 用户类型: Qualified
- 已完成: 5/10
- 当前任务列表 (最多显示3个):

| 排名 | 作品ID | 权重 | 天数 | 评分 | 高低比 | 状态 |
|-----|--------|------|------|------|--------|------|
| 1 | #042 | 82 | 28天 | 3人 | 1/2 | 超期严重 |
| 2 | #127 | 69 | 25天 | 5人 | 2/3 | 超期冷门 |
| 3 | #083 | 56 | 5天 | 1人 | 0/1 | 新作品需高权重 |

**分析**: 优先分配超期冷门，然后是需要高权重的新作品


### 场景 6.2: 普通用户李四的任务列表

**李四资料**
- 用户类型: 普通
- 已完成: 3/10
- 当前任务列表:

| 排名 | 作品ID | 权重 | 天数 | 评分 | 高低比 | 状态 |
|-----|--------|------|------|------|--------|------|
| 1 | #156 | 56 | 5天 | 1人 | 1/0 | 新作品需低权重 |
| 2 | #042 | 44 | 28天 | 3人 | 1/2 | 超期严重 |
| 3 | #089 | 35 | 10天 | 8人 | 6/2 | 高权重过多 |

**分析**: 优先引导到高权重过多的作品，平衡评分分布


### 场景 6.3: 同一作品被两类用户看到的权重差异

**作品 #234**
- 天数: 12天
- 评分: 10人 (7高/3低)
- 高权重占比: 70%

**权重表现**
- Qualified用户看到的权重: 16 (被压低)
- 普通用户看到的权重: 30 (被提升)
- 权重差距: 87.5%

**结果**: 该作品更容易出现在普通用户的任务列表前排


---

## 边界情况测试

### 边界 1: 零评分处理
- **输入**: 0人评分，无高低之分
- **期望**: 默认均衡因子 ×1.0
- **实际**: ✓ 两类用户权重相同

### 边界 2: 评分恰好20人
- **输入**: 20人评分 (达标)
- **期望**: 权重为0，不出现在任务列表
- **实际**: ✓ 评分缺口为0

### 边界 3: 超过20人评分
- **输入**: 25人评分 (超额完成)
- **期望**: 权重为负数或0
- **实际**: 需要明确 - 建议仍设为0

### 边界 4: 高权重占比恰好40%
- **输入**: 10人评分 (4高/6低)
- **期望**: 属于均衡区间
- **实际**: ✓ 因子 ×1.0

### 边界 5: 高权重占比恰好60%
- **输入**: 10人评分 (6高/4低)
- **期望**: 应属于均衡还是过多？
- **建议**: 定义为均衡 (闭区间 [40%, 60%])

### 边界 6: 天数刚好7天但评分已达10人
- **输入**: 7天, 10人评分
- **期望**: 不触发时间加成 (条件是<10评分)
- **实际**: ✓ 符合逻辑

### 边界 7: 天数刚好21天但评分已达18人
- **输入**: 21天, 18人评分
- **期望**: 不触发时间加成 (条件是<18评分)
- **实际**: ✓ 符合逻辑

### 边界 8: 天数超长但评分充足
- **输入**: 35天, 20人评分
- **期望**: 权重为0 (已达标)
- **实际**: ✓ 评分达标优先级最高


---

## 参数调优建议

### 当前参数评估

#### 1. 评分缺口系数 (当前: 45)

**优点**:
- 缺口100%时基础权重45，处于中等水平
- 为时间加成留出足够空间

**潜在问题**:
- 缺口10%时基础权重仅4.5，可能过低
- 接近目标时权重下降过快

**建议方案**:
| 方案 | 系数 | 100%缺口 | 50%缺口 | 10%缺口 | 优缺点 |
|------|------|---------|---------|---------|--------|
| 保守 | 40 | 40 | 20 | 4 | 权重整体偏低 |
| 当前 | 45 | 45 | 23 | 5 | 中等平衡 |
| 激进 | 50 | 50 | 25 | 5 | 权重整体偏高 |
| 非线性 | 45+底数 | 55 | 33 | 15 | 接近目标时仍有权重 |

**推荐**: 考虑非线性方案
```
基础权重 = 缺口比例 × 45 + 10
```
这样即使缺口10%也有权重15，确保作品不会过快消失


#### 2. 时间加成阈值 (当前: +12, +18, +25)

**当前效果分析**:
- 7天+12: 相当于额外26.7%评分缺口
- 14天+18: 相当于额外40%评分缺口
- 21天+25: 相当于额外55.6%评分缺口

**对比测试**:
| 时间点 | 评分 | 无加成 | 当前加成 | 加成后 | 提升% |
|--------|------|--------|---------|--------|-------|
| 7天 | 5人 | 34 | +12 | 46 | +35% |
| 14天 | 10人 | 23 | +18 | 41 | +78% |
| 21天 | 15人 | 11 | +25 | 36 | +227% |

**观察**: 21天加成非常强大，可能需要平衡

**建议方案**:
| 方案 | 7天 | 14天 | 21天 | 特点 |
|------|-----|------|------|------|
| 保守 | +8 | +12 | +18 | 更平缓增长 |
| 当前 | +12 | +18 | +25 | 当前设置 |
| 激进 | +15 | +25 | +35 | 强调时效性 |
| 渐进 | +10 | +20 | +30 | 等差数列 |

**推荐**: 保守方案或渐进方案，避免21天作品权重过高


#### 3. 均衡因子 (当前: 0.7 / 1.3)

**当前效果**:
- 权重差异: 85.7% (1.3/0.7)
- 反向引导力度: 强

**对比不同因子设置**:
| 方案 | 压低因子 | 提高因子 | 权重差异 | 引导强度 |
|------|---------|---------|---------|---------|
| 温和 | 0.8 | 1.2 | 50% | 弱 |
| 当前 | 0.7 | 1.3 | 85.7% | 中 |
| 激进 | 0.6 | 1.4 | 133% | 强 |
| 极端 | 0.5 | 1.5 | 200% | 极强 |

**实际效果模拟**:
基础权重30的作品:
- 温和: 24 vs 36 (差12)
- 当前: 21 vs 39 (差18)
- 激进: 18 vs 42 (差24)
- 极端: 15 vs 45 (差30)

**建议**: 
- 如果比例纠偏速度够快: 保持当前 (0.7/1.3)
- 如果纠偏太慢: 考虑激进 (0.6/1.4)
- 如果纠偏太快: 考虑温和 (0.8/1.2)


#### 4. 均衡区间 (当前: 40%-60%)

**当前设置**:
- 目标比例 1:2 对应 33.3% 高权重
- 容忍度 ±20% 对应 26.7%-40% 或 40%-53.3%
- 实际使用 40%-60%

**问题**: 实际均衡区间偏离理论目标

**建议方案**:
| 方案 | 下界 | 上界 | 目标覆盖 | 容忍度 |
|------|------|------|---------|--------|
| 严格 | 30% | 40% | 33.3% ✓ | ±7% |
| 理论 | 27% | 40% | 33.3% ✓ | ±6% / +20% |
| 当前 | 40% | 60% | 50% ✗ | 不对称 |
| 宽松 | 30% | 50% | 40% | ±10% / +50% |

**推荐**: 方案调整
```
目标比例: 1:2 (33.3%)
容忍区间: 28%-45%
- < 28%: 高权重不足
- 28%-45%: 均衡区间
- > 45%: 高权重过多
```


---

## 实际数据对比

### 模拟场景 1: 100个作品的权重分布

假设当前有100个作品:
- 20个已达标 (20+评分)
- 30个接近目标 (15-19评分)
- 30个中等进度 (8-14评分)
- 20个严重冷门 (<8评分)

**权重分布预测**:
| 作品类型 | 数量 | 平均权重Q | 平均权重L | 出现在任务列表概率 |
|---------|------|----------|----------|------------------|
| 已达标 | 20 | 0 | 0 | 0% |
| 接近目标 | 30 | 5-15 | 5-15 | 低 |
| 中等进度 | 30 | 20-35 | 20-35 | 中 |
| 严重冷门 | 20 | 45-82 | 40-70 | 高 |

**观察**: 系统有效区分冷热程度


### 模拟场景 2: 一周内的权重变化追踪

**作品 #123 的生命周期**:

| 天数 | 评分 | 高/低 | 基础权重 | 时间加成 | Q权重 | L权重 | 排名变化 |
|------|------|-------|---------|---------|-------|-------|---------|
| 1 | 0 | 0/0 | 45 | 0 | 45 | 45 | 中等 |
| 3 | 3 | 2/1 | 38 | 0 | 27 | 49 | L提升 |
| 5 | 7 | 3/4 | 29 | 0 | 29 | 29 | 持平 |
| 7 | 9 | 4/5 | 25 | +12 | 37 | 37 | 提升 |
| 10 | 13 | 6/7 | 16 | 0 | 16 | 16 | 下降 |
| 14 | 15 | 6/9 | 11 | +18 | 29 | 29 | 提升 |
| 18 | 18 | 7/11 | 5 | 0 | 5 | 5 | 下降 |
| 21 | 19 | 7/12 | 2 | +25 | 27 | 27 | 提升 |
| 24 | 20 | 8/12 | 0 | 0 | 0 | 0 | 完成 |

**观察**: 
- 时间加成在关键节点提升权重
- 比例均衡时两类用户权重相同
- 24天完成，符合预期时长


### 模拟场景 3: 高低权重纠偏效果

**作品 #456 被过多高权重用户评分**:

| 阶段 | 评分 | 高/低 | 占比 | Q权重 | L权重 | 新增评分 | 结果 |
|------|------|-------|------|-------|-------|---------|------|
| 初始 | 5 | 4/1 | 80% | 18 | 33 | 3L | 纠偏中 |
| +2天 | 8 | 4/4 | 50% | 27 | 27 | 均衡 | 均衡 |
| +2天 | 12 | 5/7 | 42% | 18 | 18 | 均衡 | 保持 |

**纠偏速度**: 约4天从80%纠正到50%


---

## 综合调优建议

### 优先级 A (高优先级调整)

#### 1. 修正均衡区间
**当前**: 40%-60%  
**建议**: 28%-45%

**理由**: 更符合1:2目标比例 (33.3%)

#### 2. 添加基础权重底数
**当前**: 缺口比例 × 45  
**建议**: 缺口比例 × 45 + 10

**理由**: 接近目标时仍保持最低权重


### 优先级 B (中优先级调整)

#### 3. 调整时间加成
**当前**: +12, +18, +25  
**建议**: +10, +20, +30 (等差数列)

**理由**: 更渐进，避免21天跳跃过大

#### 4. 细化均衡因子
**当前**: 0.7 / 1.3  
**建议**: 保持，但考虑添加渐变

```
if 占比 > 70%: 0.6 / 1.4 (极端失衡)
elif 占比 > 60%: 0.7 / 1.3 (失衡)
elif 占比 > 45%: 0.85 / 1.15 (轻微失衡)
elif 占比 >= 28%: 1.0 / 1.0 (均衡)
elif 占比 >= 20%: 0.85 / 1.15 (轻微失衡)
else: 1.3 / 0.7 (失衡)
```


### 优先级 C (低优先级优化)

#### 5. 考虑评分数权重衰减
**建议**: 评分越多，每个新评分的边际权重递减

```
有效缺口 = 实际缺口 × (1 + 当前评分数 / 40)
```

#### 6. 添加连续时间惩罚
**建议**: 超过30天的作品，每天额外 -0.5 权重

**理由**: 避免极冷门作品永久霸占列表


---

## 参数调优对照表

### 方案 A: 保守优化 (推荐)

| 参数 | 当前值 | 新值 | 变化 |
|------|--------|------|------|
| 缺口系数 | 45 | 45+10 | 添加底数 |
| 7天加成 | +12 | +10 | -2 |
| 14天加成 | +18 | +20 | +2 |
| 21天加成 | +25 | +30 | +5 |
| 均衡区间 | 40%-60% | 28%-45% | 下移 |
| 失衡因子 | 0.7/1.3 | 0.7/1.3 | 不变 |

**预期效果**:
- 接近目标作品仍有基础权重
- 时间加成更线性
- 比例控制更精确


### 方案 B: 激进优化

| 参数 | 当前值 | 新值 | 变化 |
|------|--------|------|------|
| 缺口系数 | 45 | 50+15 | 大幅提升 |
| 7天加成 | +12 | +15 | +3 |
| 14天加成 | +18 | +25 | +7 |
| 21天加成 | +25 | +40 | +15 |
| 均衡区间 | 40%-60% | 25%-40% | 严格化 |
| 失衡因子 | 0.7/1.3 | 0.6/1.4 | 加强 |

**预期效果**:
- 冷门作品更快获得关注
- 强力纠偏比例失衡
- 可能导致热门作品权重过低


### 方案 C: 渐变优化 (最推荐)

| 参数 | 当前值 | 新值 | 变化 |
|------|--------|------|------|
| 缺口系数 | 45 | 45+8 | 小底数 |
| 7天加成 | +12 | +10 | -2 |
| 14天加成 | +18 | +20 | +2 |
| 21天加成 | +25 | +30 | +5 |
| 均衡区间 | 40%-60% | 28%-45% | 精确化 |
| 失衡因子 | 阶跃 | 渐变函数 | 平滑化 |

**均衡因子渐变函数**:
```javascript
function getBalanceFactor(ratio, isHighQuality) {
  if (ratio < 0.28) {
    // 高权重严重不足
    return isHighQuality ? 1.3 : 0.7;
  } else if (ratio < 0.35) {
    // 高权重轻微不足，渐变
    const t = (ratio - 0.28) / 0.07;
    return isHighQuality ? (1.3 - 0.3*t) : (0.7 + 0.3*t);
  } else if (ratio <= 0.45) {
    // 均衡区间
    return 1.0;
  } else if (ratio <= 0.60) {
    // 高权重轻微过多，渐变
    const t = (ratio - 0.45) / 0.15;
    return isHighQuality ? (1.0 - 0.3*t) : (1.0 + 0.3*t);
  } else {
    // 高权重严重过多
    return isHighQuality ? 0.7 : 1.3;
  }
}
```

**预期效果**:
- 平滑过渡，避免边界跳跃
- 精确控制比例
- 更自然的权重分布


---

## 总结与建议

### 核心发现

1. **当前系统优点**:
   - 清晰的权重分级
   - 有效的时间紧迫感
   - 动态比例平衡机制

2. **主要问题**:
   - 均衡区间偏离目标比例
   - 接近目标时权重降为0过快
   - 边界值处理不够平滑
   - 21天加成可能过强

3. **调优方向**:
   - **首要**: 修正均衡区间到28%-45%
   - **重要**: 添加基础权重底数
   - **建议**: 实现渐变均衡因子
   - **可选**: 调整时间加成为等差数列

### 实施路径

#### 阶段 1: 立即调整
- 修改均衡区间: 40%-60% → 28%-45%
- 添加权重底数: 缺口×45 → 缺口×45+8

#### 阶段 2: 观察1周
- 收集实际数据
- 监控作品权重分布
- 监控高低比例收敛速度

#### 阶段 3: 二次优化
- 根据数据调整时间加成
- 实施渐变均衡因子
- 微调各项系数

### 测试检查清单

- [ ] 新作品能否快速获得评分
- [ ] 冷门作品能否在21天内达标
- [ ] 高低比例能否收敛到33.3%
- [ ] 接近目标的作品不会过早消失
- [ ] 不同用户看到合理的差异化任务
- [ ] 权重排序符合直觉
- [ ] 边界值处理正确
- [ ] 系统负载可接受

---

## 附录: 快速参考

### 权重计算速查表

| 评分数 | 缺口% | 基础(当前) | 基础(+8) | 基础(+10) |
|--------|-------|-----------|---------|----------|
| 0 | 100% | 45 | 53 | 55 |
| 5 | 75% | 34 | 42 | 44 |
| 10 | 50% | 23 | 31 | 33 |
| 15 | 25% | 11 | 19 | 21 |
| 18 | 10% | 5 | 13 | 15 |
| 19 | 5% | 2 | 10 | 12 |
| 20 | 0% | 0 | 8 | 10 |

### 因子应用速查

| 高权重占比 | Q用户因子 | L用户因子 | 状态 |
|-----------|----------|----------|------|
| 0-27% | 1.3 | 0.7 | 高权重不足 |
| 28-45% | 1.0 | 1.0 | 均衡(建议) |
| 46-60% | 0.7 | 1.3 | 高权重过多(建议) |
| 61-100% | 0.7 | 1.3 | 高权重严重过多 |

### 时间加成速查

| 天数 | 评分阈值 | 当前加成 | 建议加成 |
|------|---------|---------|---------|
| 7+ | <10人 | +12 | +10 |
| 14+ | <15人 | +18 | +20 |
| 21+ | <18人 | +25 | +30 |

---

**文档版本**: v1.0  
**最后更新**: 2025-01-13  
**建议复审周期**: 上线后1周、1个月、3个月


